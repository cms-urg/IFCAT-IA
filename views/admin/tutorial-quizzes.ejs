<%- include ./header -%>

<ol class="breadcrumb">
    <li><a href="/admin/courses">Courses</a> ‚Äê <%= course.code %></li>
    <li class="active">Conduct Quizzes</li>
</ol>

<h1><%- title %></h1>

<div class="nav-actions">
    <div class="btn-group">
        <button class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            Bulk Actions<span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li><a href="#" data-name="published" data-value="1">Publish</a></li>
            <li><a href="#" data-name="published" data-value="0">Unpublish</a></li>
            <li><a href="#" data-name="active" data-value="1">Activate</a></li>
            <li><a href="#" data-name="active" data-value="0">Deactivate</a></li>
            <li><a href="#" data-name="archived" data-value="1">Archive</a></li>
            <li><a href="#" data-name="archived" data-value="0">Unarchive</a></li>
            <li><a href="#" id="btn-export">Export Marks</a></li>
        </ul>
    </div>
</div>

<form method="post">
    <table class="table table-striped">
        <thead>
            <tr>
                <th style="width: 10px;"><input type="checkbox"></th>
                <th>Name</th>
                <th class="text-center">Published</th>
                <th class="text-center">Active</th>
                <th class="text-center">Archived</th>
                <th class="actions"></th>
            </tr>
        </thead>
        <tbody>
        <% if (_.isEmpty(tutorialQuizzes)) { %>
            <tr>
                <td colspan="6">No quizzes have been added for this tutorial yet.</td>
            </tr>
        <% } else { %>
            <% _.each(tutorialQuizzes, function (tutorialQuiz) { %>
                <tr>
                    <td><input type="checkbox" name="tutorialQuizzes[]" value="<%= tutorialQuiz.id %>"></td>
                    <td><%= tutorialQuiz.quiz.name %></td>
                    <td class="text-center">
                    <% if (tutorialQuiz.published) { %>
                        <span class="glyphicon glyphicon-ok"></span>
                    <% } %>
                    </td>
                    <td class="text-center">
                    <% if (tutorialQuiz.active) { %>
                        <span class="glyphicon glyphicon-ok"></span>
                    <% } %>
                    </td>
                    <td class="text-center">
                    <% if (tutorialQuiz.archived) { %>
                        <span class="glyphicon glyphicon-ok"></span>
                    <% } %>
                    </td>
                    <td>
                        <div class="dropdown">
                            <button class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
                                Actions<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a href="/admin/courses/<%= course.id %>/tutorials/<%= tutorialQuiz.tutorial.id %>/quizzes/<%= tutorialQuiz.quiz.id %>/conduct"><span class="glyphicon glyphicon-play-circle"></span> Conduct quiz</a></li>
                                <li><a href="/admin/courses/<%= course.id %>/tutorials/<%= tutorialQuiz.tutorial.id %>/quizzes/<%= tutorialQuiz.quiz.id %>/marks"><span class="glyphicon glyphicon-signal"></span> View Results</a></li>
                            </ul>
                        </div>
                    </td>
                </tr>
            <% }) %>
        <% } %>
        </tbody>
    </table>
</form>

<%- include ./body-js -%>

<script>
$(function () {
    var form = $('form');
    // update selected tutorial quizzes
    $('.dropdown-menu a[data-name]').click(function () {
        var link = $(this);
        form.append(
            '<input type="hidden" name="' + link.data('name') + '" value="' + link.data('value') + '">'
        ).attr({
            'action': '/admin/courses/<%= course.id %>/conduct/edit?_method=put'
        }).submit();
    });
    // export marks
    $('#btn-export').click(function () {
        form.attr({
            'action': '/admin/courses/<%= course.id %>/conduct/marks?export=1'
        }).submit();
    });
});
</script>

<%- include ./footer -%>